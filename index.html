<!DOCTYPE html>
<html>
<head>
  <title>MusicKit Authorization Check</title>
  <meta name="apple-music-developer-token" content="__MUSICKIT_DEVELOPER_TOKEN__" />
  <script src="https://js-cdn.music.apple.com/musickit/v3/musickit.js" async></script>
</head>
<body>
  <button id="authorize-btn">Authorize</button>
  <div id="status">Not authorized</div>

  <script>
    document.addEventListener('musickitloaded', function() {
      const authorizeBtn = document.getElementById('authorize-btn');
      const statusDiv = document.getElementById('status');
      
      // Initialize MusicKit
      MusicKit.configure({
        developerToken: "__MUSICKIT_DEVELOPER_TOKEN__",
        app: {
          name: 'MusicKit Auth Test',
        }
      }).then(function(music) {
        // Check if already authorized
        if (music.isAuthorized) {
          statusDiv.textContent = 'Already authorized';
        }
        
        // Add authorize button handler
        authorizeBtn.addEventListener('click', function() {
          music.authorize().then(function() {
            statusDiv.textContent = 'Authorization successful';
          }).catch(function(error) {
            statusDiv.textContent = 'Authorization failed: ' + error;
          });
        });
      });
    });
  </script>
</body>
</html>